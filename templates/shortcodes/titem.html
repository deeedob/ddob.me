{% set id_attr = id | default(value="") %}
{% set enddate = end | default(value="") %}

<article
  {% if id_attr != "" %} id="{{ id_attr }}" {% endif %}
  class="timeline-item group relative flex items-start"
  role="article"
  aria-label="{{ title }} — {{ date }}"
  data-date="{{ date }}"
>
  <!-- Left gutter: dot lives here -->
  <div class="timeline-gutter w-12 flex justify-center">
    <div class="timeline-dot" aria-hidden="true"></div>
  </div>

  <!-- Card (content) -->
  <div class="timeline-card relative bg-panel rounded-2xl p-4 md:p-5 shadow-none transition-transform transition-shadow duration-200">
    <!-- small connector from dot to card (pseudo element via CSS) -->
    <div class="flex items-baseline justify-between gap-3">
      <h3 class="text-base md:text-lg font-semibold text-content leading-tight" style="margin:0 !important; padding:0 !important;">
        {{ title }}
      </h3>

      <div class="timeline-meta text-sm text-content-muted whitespace-nowrap">
        {% if enddate == "current" %}
          <time>{{ date }}</time> —
          <time data-controller="timeisnow" aria-hidden="true">now</time>
          <span class="sr-only">until now</span>
        {% elif enddate != "" %}
          <time>{{ date }}</time> — <time>{{ enddate }}</time>
        {% else %}
          <time>{{ date }}</time>
        {% endif %}
      </div>
    </div>

    {% if institution %}
      <div class="text-sm text-content-muted">{{ institution }}</div>
    {% endif %}

    <div class="mt-3 prose max-w-none">
      {{ body | markdown | safe }}
    </div>
  </div>
</article>
